mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_english_speaker = "Percent English Speakers",
mean_is_citizen = "Percent Citizen",
mean_age_at_immigration = "Mean Age at Immigration",
mean_years_in_us = "Average Years in US",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed"
))
}
table_sex_1 <- create_table_for_sex(1)
table_sex_2 <- create_table_for_sex(2)
combined_table <- bind_rows(
table_sex_2, #females first
table_sex_1 #males second
)
combined_table <- combined_table %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table)
table2_code <- xtable(combined_table, caption = "Summary Statistics by Country and Sex",
label = "table2")
sink("/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/table2.tex")
print(table2_code, type = "latex",
caption.placement = "top",
size = "\\small")
sink()
getwd()
age_weights <- read_csv("data/us_age_weights.csv")
getwd()
age_weights <- read_csv("/Users/chrissoria/Documents/Research/us_international_ses/data/us_age_weights.csv")
View(age_weights)
sum(age_weights$age_weight)
View(in_df)
in_df <- in_df %>%
mutate(age2 = as_factor(age2))
in_df <- left_join(in_df, age_weights, by = "age2")
age_weights <- age_weights %>%
select(-perwt)
us_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/US_65_89.dta")
us_df <- us_df %>%
mutate(bplcountry = as_factor(bplcountry))
in_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/international__65_89.dta")
in_df <- in_df %>%
mutate(age2 = as_factor(age2))
age_weights <- read_csv("/Users/chrissoria/Documents/Research/us_international_ses/data/us_age_weights.csv")
age_weights <- age_weights %>%
select(-perwt)
sum(age_weights$age_weight) #sums to 1
in_df <- left_join(in_df, age_weights, by = "age2")
sum(age_weights$age_weight) #sums to 1
in_df <- left_join(in_df, age_weights, by = "age2") %>%
mutate(perwt_age_standardized = perwt * age_weight)
us_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/US_65_89.dta")
us_df <- us_df %>%
mutate(bplcountry = as_factor(bplcountry))
in_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/international__65_89.dta")
in_df <- in_df %>%
mutate(age2 = as_factor(age2))
age_weights <- read_csv("/Users/chrissoria/Documents/Research/us_international_ses/data/us_age_weights.csv")
age_weights <- age_weights %>%
select(-perwt)
sum(age_weights$age_weight) #sums to 1
in_df <- left_join(in_df, age_weights, by = "age2") %>%
mutate(perwt_age_standardized = perwt * age_weight)
table1_not_weighted <- in_df %>%
group_by(country) %>%
summarise(
mean_married_cohab = weighted.mean(married_cohab, perwt, na.rm = TRUE),
mean_yrschool = weighted.mean(yrschool, perwt, na.rm = TRUE),
mean_sex = weighted.mean(sex, perwt, na.rm = TRUE),
mean_age = weighted.mean(age, perwt, na.rm = TRUE)
)
table1_not_weighted
table1 <- in_df %>%
group_by(country) %>%
summarise(
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_yrschool = weighted.mean(yrschool, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(sex, perwt_age_standardized, na.rm = TRUE),
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE)
)
table1
us_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/US_65_89.dta")
us_df <- us_df %>%
mutate(bplcountry = as_factor(bplcountry))
in_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/international__65_89.dta")
table1 <- in_df %>%
group_by(country) %>%
summarise(
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt, na.rm = TRUE)
)
table1
us_df$bplcountry
in_df$country
in_df <- in_df %>%
mutate(country = as_factor(country))
table1 <- in_df %>%
group_by(country) %>%
summarise(
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt, na.rm = TRUE)
)
table1
us_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/US_65_89.dta")
us_df <- us_df %>%
mutate(bplcountry = as_factor(bplcountry))
in_df <- read_dta("/Users/chrissoria/Documents/Research/us_international_ses/data/international__65_89.dta")
in_df <- in_df %>%
mutate(country = as_factor(country))
create_table_for_sex_international <- function(sex_value) {
us_df %>%
filter(sex == sex_value) %>%
filter(bplcountry != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt, na.rm = TRUE)
) %>%
pivot_longer(cols = -bplcountry, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = bplcountry, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
create_table_for_sex_international <- function(sex_value) {
us_df %>%
filter(sex == sex_value) %>%
filter(bplcountry != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -bplcountry, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = bplcountry, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
create_table_for_sex_international <- function(sex_value) {
in_df %>%
filter(sex == sex_value) %>%
filter(bplcountry != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -bplcountry, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = bplcountry, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
create_table_for_sex_international <- function(sex_value) {
in_df %>%
filter(sex == sex_value) %>%
filter(country != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -bplcountry, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = bplcountry, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
create_table_for_sex_international <- function(sex_value) {
in_df %>%
filter(sex == sex_value) %>%
filter(country != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -country, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = country, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
table1_sex_2 <- create_table_for_sex_international(2)
combined_table1 <- bind_rows(
table1_sex_1, #females first
table1_sex_2 #males second
)
combined_table1 <- combined_table1 %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table1)
table1_code <- xtable(combined_table1, caption = "Summary Statistics by Country and Sex For Hispanics in Their Native Countries",
label = "table1")
sink("/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/table1.tex")
print(table2_code, type = "latex",
caption.placement = "top",
size = "\\small")
sink()
create_table_for_sex_international <- function(sex_value) {
in_df %>%
filter(sex == sex_value) %>%
filter(country != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_sex = weighted.mean(female, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -country, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = country, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
table1_sex_2 <- create_table_for_sex_international(2)
combined_table1 <- bind_rows(
table1_sex_1, #females first
table1_sex_2 #males second
)
combined_table1 <- combined_table1 %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table1)
table1_code <- xtable(combined_table1, caption = "Summary Statistics by Country and Sex For Hispanics in Their Native Countries",
label = "table1")
sink("/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/table1.tex")
print(table2_code, type = "latex",
caption.placement = "top",
size = "\\small")
sink()
create_table_for_sex_international <- function(sex_value) {
in_df %>%
filter(sex == sex_value) %>%
filter(country != "United States") %>%
group_by(country) %>%
summarise(
mean_age = weighted.mean(age, perwt_age_standardized, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -country, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = country, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
table1_sex_2 <- create_table_for_sex_international(2)
combined_table1 <- bind_rows(
table1_sex_1, #females first
table1_sex_2 #males second
)
combined_table1 <- combined_table1 %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table1)
table1_code <- xtable(combined_table1, caption = "Summary Statistics by Country and Sex For Hispanics in Their Native Countries",
label = "table1")
sink("/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/table1.tex")
print(table2_code, type = "latex",
caption.placement = "top",
size = "\\small")
sink()
create_table_for_sex_international <- function(sex_value) {
in_df %>%
filter(sex == sex_value) %>%
filter(country != "United States") %>%
group_by(country) %>%
summarise(
mean_age = mean(age, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt_age_standardized, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt_age_standardized, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt_age_standardized, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt_age_standardized, na.rm = TRUE),
mean_education_unknown = weighted.mean(education_unknown, perwt_age_standardized, na.rm = TRUE)
) %>%
pivot_longer(cols = -country, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = country, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed",
mean_education_unknown = "Percent Unknown Education Attained"
))
}
table1_sex_1 <- create_table_for_sex_international(1)
table1_sex_2 <- create_table_for_sex_international(2)
combined_table1 <- bind_rows(
table1_sex_1, #females first
table1_sex_2 #males second
)
combined_table1 <- combined_table1 %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table1)
table1_code <- xtable(combined_table1, caption = "Summary Statistics by Country and Sex For Hispanics in Their Native Countries",
label = "table1")
sink("/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/table1.tex")
print(table2_code, type = "latex",
caption.placement = "top",
size = "\\small")
sink()
create_table_for_sex <- function(sex_value) {
us_df %>%
filter(sex == sex_value) %>%
group_by(bplcountry) %>%
summarise(
mean_age = weighted.mean(age, perwt, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt, na.rm = TRUE),
mean_english_speaker = weighted.mean(english_speaker, perwt, na.rm = TRUE),
mean_is_citizen = weighted.mean(is_citizen, perwt, na.rm = TRUE),
mean_age_at_immigration = weighted.mean(age_at_immigration, perwt, na.rm = TRUE),
mean_years_in_us = weighted.mean(years_in_us, perwt, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt, na.rm = TRUE)
) %>%
pivot_longer(cols = -bplcountry, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = bplcountry, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Average Age",
mean_married_cohab = "Percent Married/Cohabiting",
mean_english_speaker = "Percent English Speakers",
mean_is_citizen = "Percent Citizen",
mean_age_at_immigration = "Mean Age at Immigration",
mean_years_in_us = "Average Years in US",
mean_less_than_primary_completed = "Percent Less than Primary Completed",
mean_primary_completed = "Percent Primary Completed",
mean_secondary_completed = "Percent Secondary Completed",
mean_university_completed = "Percent University Completed"
))
}
table_sex_1 <- create_table_for_sex(1)
table_sex_2 <- create_table_for_sex(2)
combined_table <- bind_rows(
table_sex_2, #females first
table_sex_1 #males second
)
combined_table <- combined_table %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table)
table2_code <- xtable(combined_table, caption = "Summary Statistics by Country and Sex",
label = "table2")
sink("/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/table2.tex")
print(table2_code, type = "latex",
caption.placement = "top",
size = "\\small")
sink()
create_table_for_sex <- function(sex_value) {
us_df %>%
filter(sex == sex_value) %>%
group_by(bplcountry) %>%
summarise(
mean_age = weighted.mean(age, perwt, na.rm = TRUE),
mean_married_cohab = weighted.mean(married_cohab, perwt, na.rm = TRUE),
mean_english_speaker = weighted.mean(english_speaker, perwt, na.rm = TRUE),
mean_is_citizen = weighted.mean(is_citizen, perwt, na.rm = TRUE),
mean_age_at_immigration = weighted.mean(age_at_immigration, perwt, na.rm = TRUE),
mean_years_in_us = weighted.mean(years_in_us, perwt, na.rm = TRUE),
mean_less_than_primary_completed = weighted.mean(less_than_primary_completed, perwt, na.rm = TRUE),
mean_primary_completed = weighted.mean(primary_completed, perwt, na.rm = TRUE),
mean_secondary_completed = weighted.mean(secondary_completed, perwt, na.rm = TRUE),
mean_university_completed = weighted.mean(university_completed, perwt, na.rm = TRUE)
) %>%
pivot_longer(cols = -bplcountry, names_to = "variable", values_to = "value") %>%
pivot_wider(names_from = bplcountry, values_from = value) %>%
mutate(variable = recode(variable,
mean_age = "Age",
mean_married_cohab = "Married/Cohabiting",
mean_english_speaker = "English Speakers",
mean_is_citizen = "Citizen",
mean_age_at_immigration = "Age at Immigration",
mean_years_in_us = "Years in US",
mean_less_than_primary_completed = "Less than Primary Completed",
mean_primary_completed = "Primary Completed",
mean_secondary_completed = "Secondary Completed",
mean_university_completed = "University Completed"
))
}
table_sex_1 <- create_table_for_sex(1)
table_sex_2 <- create_table_for_sex(2)
combined_table <- bind_rows(
table_sex_2, #females first
table_sex_1 #males second
)
combined_table <- combined_table %>%
mutate(across(where(is.numeric), round, digits = 2)) %>%
mutate(across(everything(), ~ as.character(.))) %>%
mutate(across(everything(), ~ ifelse(. == "NaN", "-", .))) %>%
mutate(across(everything(), ~ ifelse(. == "0", "-", .)))
print(combined_table)
